<!DOCTYPE HTML>
<html>


<body>

<div id="sse">
    <a href="javascript:WebSocketTest()">运行 WebSocket</a>
</div>

</body>
<script>
    var websocket = null;
    if ('WebSocket' in window) {
        websocket = new WebSocket("ws://127.0.0.1:8080/websocket/testname");
    }

    websocket.onopen = function () {
        console.log("连接成功");
    }

    websocket.onclose = function () {
        console.log("退出连接");
    }

    websocket.onmessage = function (event) {
        console.log("收到消息" + event.data);
    }

    websocket.onerror = function () {
        console.log("连接出错");
    }

    window.onbeforeunload = function () {
        websocket.close(num);
    }
</script>
</html>
